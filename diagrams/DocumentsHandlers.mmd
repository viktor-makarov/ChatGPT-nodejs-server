---
title: Documents Handlers
config:
  theme: neutral
---

%% Diagram generated by LLM
flowchart TD
    mediaFile@{ shape: docs, label: "Audio/video files" }
    image@{ shape: docs, label: "Image files" }
    document@{ shape: docs, label: "Document files (PDF, MS Office and text)"}
    url@{ shape: rect, label: "Internet URLs" }

    outputDocs@{ shape: doc, label: "PDF and text documents" }

    extract_content@{ shape: process, label: "'Extract content' and 'fetch url' functions" }
    save_to_document@{ shape: process, label: "'Save to document' <br/> - no changes to content" }
    generate_document@{ shape: process, label: "'Generate document' function <br/> - modifies content <br/> - supports large documents" }

    tempStorage@{ shape: cylinder, label: "Temporary Storage" }
    dialogue@{ shape: rect, label: "Main dialogue" }
    user_prompt@{ shape: note, label: "User prompt" }

    mediaFile -->|"Speech to text API"| extract_content
    image -->|"OCR (Google API)"| extract_content
    document --> |"OCR (Google API) and Apache Tika (AWS Lambda)"| extract_content
    url --> |"Puppeteer"| extract_content

    extract_content -->|"All content"| tempStorage
    extract_content -->|"Content below token limit"| dialogue

    tempStorage --> save_to_document
    dialogue --> generate_document
    user_prompt --> generate_document

    save_to_document -->|"Send to user"| outputDocs
    generate_document -->|"Send to user"| outputDocs

    %% Styles
    classDef input fill:#e3f2fd,stroke:#1976d2,stroke-width:2px,font-family:Arial;
    classDef output fill:#e8f5e8,stroke:#388e3c,stroke-width:2px,font-family:Arial;
    classDef functions fill:#fff3e0,stroke:#f57c00,stroke-width:2px,font-family:Arial;
    classDef tempstorage fill:#f3e5f5,stroke:#7b1fa2,stroke-width:2px,font-family:Arial;
    classDef dialogue fill:#fce4ec,stroke:#c2185b,stroke-width:2px,font-family:Arial;

    class mediaFile,image,document,url input;
    class outputDocs output;
    class extract_content,save_to_document,generate_document functions;
    class tempStorage tempstorage;
    class dialogue dialogue;